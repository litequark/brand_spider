name: "Retrieve & upload data (with dependencies solved)"
description: "Install Python dependencies, run python spider script and upload artifacts."
inputs:
  script-name:
    description: "Script name (without extension), e.g.: benz"
    required: true

runs:
  using: "composite"

  steps:
    - name: "Satisfy requirements.txt"
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
      shell: bash

    - name: "Retrieve data"
      run: |
        python '${{ github.workspace }}/scripts/${{ inputs.script-name }}.py'
      shell: bash

    - name: "Upload data"
      uses: actions/upload-artifact@v4
      with:
        name: ${{ inputs.script-name }}
        path: ${{ github.workspace }}/output/*.csv
        if-no-files-found: 'error'